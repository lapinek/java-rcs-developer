SKAFFOLD_DEFAULT_REPO=gcr.io/engineering-devops/olaf
TENANT_NAME=openam-olaf
SERVICE_CLIENT_ID=oauth2_client_application
SERVICE_CLIENT_SECRET="\$ecret"
SERVICE_USER_USERNAME=olaf.0
SERVICE_USER_PASSWORD="\`0l@f\`"

AUTHORIZATION_HEADER_VALUE="Bearer "$( \
    echo $( \
        curl -s --location --request POST "https://$TENANT_NAME.forgeblocks.com/am/oauth2/realms/root/realms/alpha/access_token" \
        --header "Authorization: Basic $(printf  "$SERVICE_CLIENT_ID:$SERVICE_CLIENT_SECRET" | base64)" \
        --header "Content-Type: application/x-www-form-urlencoded" \
        --data-urlencode "grant_type=password" \
        --data-urlencode "scope=fr:idm:*" \
        --data-urlencode "username=${SERVICE_USER_USERNAME}" \
        --data-urlencode "password=${SERVICE_USER_PASSWORD}" \
    ) | sed -e 's/^.*"access_token":"\([^"]*\)".*$/\1/' \
)